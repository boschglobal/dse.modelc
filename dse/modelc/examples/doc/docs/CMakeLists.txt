# Copyright 2024 Robert Bosch GmbH
#
# SPDX-License-Identifier: Apache-2.0

cmake_minimum_required(VERSION 3.21)
cmake_policy(SET CMP0135 NEW)

set(VERSION "$ENV{PACKAGE_VERSION}")

project(apis DESCRIPTION "ModelC - Example Code")

set(CMAKE_C_STANDARD 99)
set(CMAKE_C_STANDARD_REQUIRED TRUE)
set(CMAKE_POSITION_INDEPENDENT_CODE ON)
set(CMAKE_C_FLAGS_DEBUG "-g -ggdb")
set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} -O3")
list(APPEND C_CXX_WARNING_FLAGS
    -Wall
    -W
    -Wwrite-strings
    -Wno-missing-field-initializers
    -Wno-misleading-indentation
)
add_compile_options(${C_CXX_WARNING_FLAGS})

# APIs
# ----
add_library(docs OBJECT
    ncodec/ncodec_config.c
    ncodec/ncodec_model.c
    ncodec/ncodec_test.c
)
target_link_libraries(docs
    PRIVATE
        ab-codec
)
target_include_directories(docs
    PRIVATE
        ${DSE_CLIB_INCLUDE_DIR}
        ${DSE_NCODEC_INCLUDE_DIR}
        ../../../../..
)
target_compile_definitions(docs
    PUBLIC
        CMOCKA_TESTING
)
